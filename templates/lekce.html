{% extends "base.html" %}

{% block title %}{{ lesson.title }} - {{ course.title }}{% endblock %}

{% block content %}
<div class="container">
    <!-- Lesson Header -->
    <div class="row mb-4">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Dom≈Ø</a></li>
                    <li class="breadcrumb-item"><a href="/kurz/{{ course_id }}">{{ course.title }}</a></li>
                    <li class="breadcrumb-item active">{{ lesson.title }}</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="row">
        <!-- Lesson Content -->
        <div class="col-lg-8">
            <div class="lesson-content-section">
                <div class="lesson-header">
                    <div class="lesson-icon">
                        {% if course_id == "uvod" %}
                            <i class="fas fa-play-circle text-primary"></i>
                        {% elif course_id == "zaklady" %}
                            <i class="fas fa-code text-success"></i>
                        {% else %}
                            <i class="fas fa-rocket text-warning"></i>
                        {% endif %}
                    </div>
                    <h1 class="lesson-title-main">{{ lesson.title }}</h1>
                    <p class="lesson-description-main">{{ lesson.description }}</p>
                </div>

                <!-- Lesson Content -->
                <div class="lesson-content-body">
                    {% if lesson.title == "Co je Python?" %}
                    <div class="lesson-content-actual">
                        <div class="lesson-intro">
                            <div class="intro-icon">
                                <i class="fas fa-python text-primary"></i>
                            </div>
                            <h3>üêç Co je Python?</h3>
                            <p class="intro-text">
                                Python je <strong>super z√°bavn√Ω programovac√≠ jazyk</strong>, kter√Ω je jako kouzeln√° h≈Ølka pro poƒç√≠taƒçe! 
                                S Pythonem m≈Ø≈æe≈° vytv√°≈ôet √∫≈æasn√© vƒõci a st√°t se mal√Ωm program√°torem! üöÄ
                            </p>
                        </div>

                        <div class="lesson-sections">
                            <div class="lesson-section">
                                <h4><i class="fas fa-star text-warning me-2"></i>Proƒç je Python skvƒõl√Ω?</h4>
                                <div class="section-content">
                                    <div class="feature-grid">
                                        <div class="feature-item">
                                            <i class="fas fa-heart text-danger"></i>
                                            <h5>Snadn√Ω na uƒçen√≠</h5>
                                            <p>Python je jako psan√≠ v angliƒçtinƒõ - rozum√≠≈° mu hned!</p>
                                        </div>
                                        <div class="feature-item">
                                            <i class="fas fa-rocket text-success"></i>
                                            <h5>Rychl√Ω start</h5>
                                            <p>Za p√°r minut m≈Ø≈æe≈° vytvo≈ôit sv≈Øj prvn√≠ program!</p>
                                        </div>
                                        <div class="feature-item">
                                            <i class="fas fa-magic text-primary"></i>
                                            <h5>Kouzeln√© mo≈ænosti</h5>
                                            <p>M≈Ø≈æe≈° dƒõlat skoro cokoliv - hry, roboty, webov√© str√°nky!</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="lesson-section">
                                <h4><i class="fas fa-gamepad text-info me-2"></i>Co v≈°echno m≈Ø≈æe≈° s Pythonem vytvo≈ôit?</h4>
                                <div class="section-content">
                                    <div class="use-cases">
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-gamepad"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>üéÆ Hry a z√°bava</h5>
                                                <p>Vytvo≈ô si vlastn√≠ hry, animace a interaktivn√≠ p≈ô√≠bƒõhy!</p>
                                                <small>Minecraft mody, h√°danky, kv√≠zy</small>
                                            </div>
                                        </div>
                                        
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-robot"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>ü§ñ Robotika a AI</h5>
                                                <p>Naprogramuj roboty, kte≈ô√≠ tƒõ poslouchaj√≠ a pom√°haj√≠ ti!</p>
                                                <small>Lego roboti, chytr√© domy, umƒõl√° inteligence</small>
                                            </div>
                                        </div>
                                        
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-globe"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>üåê Webov√© str√°nky</h5>
                                                <p>Vytvo≈ô si vlastn√≠ webov√© str√°nky a aplikace!</p>
                                                <small>Instagram, YouTube, TikTok - v≈°echny pou≈æ√≠vaj√≠ Python!</small>
                                            </div>
                                        </div>
                                        
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-chart-line"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>üìä Vƒõda a data</h5>
                                                <p>Analyzuj data, vytv√°≈ôej grafy a objevuj tajemstv√≠!</p>
                                                <small>Vƒõdeck√© experimenty, p≈ôedpovƒõdi poƒças√≠</small>
                                            </div>
                                        </div>
                                        
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-mobile-alt"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>üì± Mobiln√≠ aplikace</h5>
                                                <p>Vytvo≈ô si vlastn√≠ aplikace do telefonu!</p>
                                                <small>Hry, kalkulaƒçky, organiz√©ry</small>
                                            </div>
                                        </div>
                                        
                                        <div class="use-case">
                                            <div class="use-case-icon">
                                                <i class="fas fa-palette"></i>
                                            </div>
                                            <div class="use-case-content">
                                                <h5>üé® Umƒõn√≠ a design</h5>
                                                <p>Vytv√°≈ôej digit√°ln√≠ umƒõn√≠ a animace!</p>
                                                <small>Kreslen√≠, animace, hudba</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="lesson-section">
                                <h4><i class="fas fa-lightbulb text-warning me-2"></i>Proƒç se uƒçit Python u≈æ teƒè?</h4>
                                <div class="section-content">
                                    <div class="benefits">
                                        <div class="benefit-item">
                                            <i class="fas fa-trophy text-warning"></i>
                                            <h5>Budoucnost je digit√°ln√≠</h5>
                                            <p>Programov√°n√≠ bude stejnƒõ d≈Øle≈æit√© jako ƒçten√≠ a psan√≠!</p>
                                        </div>
                                        <div class="benefit-item">
                                            <i class="fas fa-brain text-info"></i>
                                            <h5>Rozv√≠j√≠≈° logick√© my≈°len√≠</h5>
                                            <p>Python tƒõ nauƒç√≠ ≈ôe≈°it probl√©my krok za krokem!</p>
                                        </div>
                                        <div class="benefit-item">
                                            <i class="fas fa-users text-success"></i>
                                            <h5>M≈Ø≈æe≈° pom√°hat ostatn√≠m</h5>
                                            <p>Vytvo≈ô√≠≈° programy, kter√© usnadn√≠ ≈æivot tobƒõ i kamar√°d≈Øm!</p>
                                        </div>
                                        <div class="benefit-item">
                                            <i class="fas fa-money-bill-wave text-primary"></i>
                                            <h5>Lep≈°√≠ pr√°ce v budoucnosti</h5>
                                            <p>Program√°to≈ôi jsou velmi ≈æ√°dan√≠ a dob≈ôe placen√≠!</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="lesson-section">
                                <h4><i class="fas fa-rocket text-danger me-2"></i>P≈ôipraven zaƒç√≠t?</h4>
                                <div class="section-content">
                                    <div class="ready-to-start">
                                        <p class="ready-text">
                                            <strong>Python je jako kouzeln√° h≈Ølka</strong> - s n√≠m m≈Ø≈æe≈° vytvo≈ôit cokoliv si p≈ôedstav√≠≈°! 
                                            Od jednoduch√Ωch kalkulaƒçek a≈æ po slo≈æit√© hry a roboty.
                                        </p>
                                        <div class="ready-features">
                                            <div class="ready-feature">
                                                <i class="fas fa-check-circle text-success"></i>
                                                <span>Zaƒçne≈° s jednoduch√Ωmi p≈ô√≠kazy</span>
                                            </div>
                                            <div class="ready-feature">
                                                <i class="fas fa-check-circle text-success"></i>
                                                <span>Postupnƒõ se nauƒç√≠≈° slo≈æitƒõj≈°√≠ vƒõci</span>
                                            </div>
                                            <div class="ready-feature">
                                                <i class="fas fa-check-circle text-success"></i>
                                                <span>Vytvo≈ô√≠≈° si vlastn√≠ projekty</span>
                                            </div>
                                        </div>
                                        <p class="ready-encouragement">
                                            <strong>Neboj se!</strong> Python je navr≈æen√Ω tak, aby byl z√°bavn√Ω a snadn√Ω na uƒçen√≠. 
                                            Ka≈æd√Ω program√°tor zaƒç√≠nal stejnƒõ jako ty - s prvn√≠m "Ahoj, svƒõte!" üéâ
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="content-placeholder">
                        <div class="placeholder-icon">
                            <i class="fas fa-book-open text-muted"></i>
                        </div>
                        <h3>Obsah lekce</h3>
                        <p class="text-muted">
                            Tato lekce je p≈ôipravena pro budouc√≠ obsah. Zde bude:
                        </p>
                        <ul class="text-muted">
                            <li>Teoretick√© vysvƒõtlen√≠ t√©matu</li>
                            <li>Praktick√© p≈ô√≠klady k√≥du</li>
                            <li>Interaktivn√≠ cviƒçen√≠</li>
                            <li>Testov√°n√≠ znalost√≠</li>
                        </ul>
                    </div>
                    {% endif %}

                    <!-- Sample Code Example -->
                    <div class="code-example">
                        <h4><i class="fas fa-code me-2"></i>Uk√°zkov√Ω k√≥d</h4>
                        <div class="code-block">
                            <pre><code># {{ lesson.title }}
print("Ahoj, svƒõte!")
print("V√≠tejte v lekci: {{ lesson.title }}")

# Toto je uk√°zkov√Ω k√≥d pro lekci
jmeno = "{{ student.name }}"
print(f"Ahoj, {jmeno}!")

# Zkuste si tento k√≥d v Python Playground
for i in range(3):
    print(f"Poƒç√≠t√°m: {i + 1}")</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Lesson Actions -->
                <div class="lesson-actions">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <a href="/playground" class="btn btn-success w-100">
                                <i class="fas fa-code me-2"></i>Vyzkou≈°et v Playground
                            </a>
                        </div>
                        <div class="col-md-6">
                            {% if lesson.id not in student.completed_lessons %}
                            <button class="btn btn-primary w-100" onclick="markAsCompleted('{{ lesson.id }}')">
                                <i class="fas fa-check me-2"></i>Oznaƒçit jako dokonƒçen√©
                            </button>
                            {% else %}
                            <button class="btn btn-outline-success w-100" disabled>
                                <i class="fas fa-check me-2"></i>Lekce dokonƒçena
                            </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <div class="lesson-sidebar">
                <!-- Progress Card -->
                <div class="sidebar-card">
                    <h5><i class="fas fa-chart-line me-2"></i>Pokrok v kurzu</h5>
            <div class="progress mb-2">
                <div class="progress-bar" role="progressbar" 
                     style="width: {{ (student.completed_lessons|length / course.lessons|length * 100)|round }}%"
                     data-width="{{ (student.completed_lessons|length / course.lessons|length * 100)|round }}">
                </div>
            </div>
                    <small class="text-muted">
                        {{ student.completed_lessons|length }} z {{ course.lessons|length }} lekc√≠
                    </small>
                </div>

                <!-- Navigation Card -->
                <div class="sidebar-card">
                    <h5><i class="fas fa-list me-2"></i>Lekce v kurzu</h5>
                    <div class="lesson-list">
                        {% for l in course.lessons %}
                        <div class="lesson-item {% if l.id == lesson.id %}active{% endif %}">
                            <div class="lesson-item-number">{{ loop.index }}</div>
                            <div class="lesson-item-content">
                                <a href="/lekce/{{ course_id }}/{{ l.id }}" 
                                   class="lesson-item-link {% if l.id == lesson.id %}active{% endif %}">
                                    {{ l.title }}
                                </a>
                                {% if l.id in student.completed_lessons %}
                                    <i class="fas fa-check text-success lesson-item-status"></i>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="sidebar-card">
                    <h5><i class="fas fa-bolt me-2"></i>Rychl√© akce</h5>
                    <div class="d-grid gap-2">
                        <a href="/kurz/{{ course_id }}" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-arrow-left me-1"></i>Zpƒõt na kurz
                        </a>
                        <a href="/playground" class="btn btn-outline-success btn-sm">
                            <i class="fas fa-code me-1"></i>Playground
                        </a>
                        <a href="/profil" class="btn btn-outline-info btn-sm">
                            <i class="fas fa-user me-1"></i>M≈Øj profil
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Nastaven√≠ progress baru
document.addEventListener('DOMContentLoaded', function() {
    const progressBars = document.querySelectorAll('.progress-bar[data-width]');
    progressBars.forEach(bar => {
        const width = bar.getAttribute('data-width');
        bar.style.width = width + '%';
    });
});

async function markAsCompleted(lessonId) {
    try {
        const formData = new FormData();
        formData.append('lesson_id', lessonId);
        
        const response = await fetch('/update_progress', {
            method: 'POST',
            body: formData
        });
        
        if (response.ok) {
            location.reload();
        } else {
            alert('Chyba p≈ôi oznaƒçov√°n√≠ lekce jako dokonƒçen√©');
        }
    } catch (error) {
        alert('Chyba: ' + error.message);
    }
}
</script>
{% endblock %}
